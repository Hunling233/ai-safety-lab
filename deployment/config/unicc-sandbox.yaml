# AI Safety Lab - UNICC Sandbox Configuration
# UNICC AI沙盒特定配置文件

apiVersion: v1
kind: ConfigMap
metadata:
  name: unicc-sandbox-config
  namespace: unicc-aisafety
data:
  # UNICC沙盒环境配置
  environment: "sandbox"
  region: "unicc-central"
  security_level: "high"
  
  # 网络策略
  network_policy: |
    allowed_ingress:
      - source: "unicc-network"
        ports: [80, 443]
      - source: "internal-services"
        ports: [8000, 8501]
    
    allowed_egress:
      - destination: "api.openai.com"
        ports: [443]
      - destination: "api.anthropic.com"
        ports: [443]
      - destination: "internal-dns"
        ports: [53]
  
  # 安全策略
  security_policy: |
    authentication:
      enabled: true
      method: "unicc-sso"
      token_ttl: 3600
    
    authorization:
      rbac_enabled: true
      default_role: "viewer"
      admin_roles: ["unicc-admin", "aisafety-admin"]
    
    data_protection:
      encryption_at_rest: true
      encryption_in_transit: true
      key_rotation: "30d"
      audit_all_access: true
  
  # 资源限制
  resource_limits: |
    per_namespace:
      cpu: "4000m"
      memory: "8Gi"
      storage: "50Gi"
      pods: 10
    
    per_pod:
      cpu: "1000m"
      memory: "2Gi"
      ephemeral_storage: "5Gi"
  
  # 监控配置
  monitoring: |
    metrics:
      enabled: true
      scrape_interval: "30s"
      retention: "30d"
    
    logging:
      level: "INFO"
      format: "json"
      retention: "90d"
      shipping: "unicc-logaggregator"
    
    alerting:
      channels: ["unicc-alerts", "aisafety-team"]
      thresholds:
        cpu_usage: 80
        memory_usage: 85
        error_rate: 5
        response_time: 2000
  
  # 备份策略
  backup: |
    schedule: "0 2 * * *"  # 每天凌晨2点
    retention:
      daily: 7
      weekly: 4
      monthly: 12
    destinations:
      - "unicc-backup-storage"
      - "offsite-backup"
    
    what_to_backup:
      - kubernetes_configs
      - application_data
      - logs
      - user_configurations

---
# 安全策略 (SecurityPolicy CRD)
apiVersion: security.unicc.org/v1
kind: SecurityPolicy
metadata:
  name: ai-safety-security-policy
  namespace: unicc-aisafety
spec:
  # Pod安全策略
  podSecurityPolicy:
    runAsNonRoot: true
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: false
    requiredDropCapabilities:
      - ALL
    allowedCapabilities: []
    
    # 资源限制
    resources:
      requests:
        memory: "128Mi"
        cpu: "100m"
      limits:
        memory: "2Gi"
        cpu: "1000m"
  
  # 网络安全策略
  networkPolicy:
    default: "deny-all"
    allowedConnections:
      - from: "same-namespace"
      - from: "unicc-monitoring"
      - to: "external-apis"
  
  # 数据分类
  dataClassification:
    level: "internal"
    categories: ["ai-models", "test-results", "configuration"]
    retention: "1-year"
    
  # 审计要求
  auditRequirements:
    logAllAccess: true
    logDataAccess: true
    logAdminActions: true
    retentionPeriod: "7-years"

---
# 合规性配置
apiVersion: compliance.unicc.org/v1
kind: CompliancePolicy
metadata:
  name: ai-safety-compliance
  namespace: unicc-aisafety
spec:
  # 适用的合规标准
  standards:
    - "UNICC-AI-2024"
    - "ISO-27001"
    - "SOC2-TYPE2"
  
  # 数据处理要求
  dataProcessing:
    lawfulBasis: "legitimate-interest"
    minimization: true
    accuracy: true
    retention: "as-configured"
    
  # 技术措施
  technicalMeasures:
    encryption:
      atRest: "AES-256"
      inTransit: "TLS-1.3"
    
    accessControl:
      authentication: "required"
      authorization: "rbac"
      sessionManagement: "secure"
    
    monitoring:
      logging: "comprehensive"
      alerting: "enabled"
      incident_response: "automated"
      
  # 组织措施
  organizationalMeasures:
    training: "required"
    documentation: "maintained"
    incident_procedures: "defined"
    regular_audits: "quarterly"